JavaScript SDK Unit Tests
Test run date: 01/03/2024


Test Description: Successfully retrieve public key.

    Input:
    null

    Expected Output:
    "Valid PEM formatted base64 encoded public key"

    Actual Output:
    "-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvdnHTmzp7FWqli/JviR1\nfFDpsMbUenzNHzuahlLHANXIhenOfVwmBXZOJoR2+QwIoZIktrz6eGwk+MMX+1XW\nL8QZglsSdgwHTLLeuW3fgS4m4eGkLRhkytvD4KWNPw2Aiv/+BDUR1QIYfngLrkFS\nKy/3YOk+4SiYtkkRjzPf5p8Mi5mT7M9n7TNDfML6bL/APlGnULQnQmA0GRh8MHRl\n68U5nRNvtC087MM1nRLE1HOSyMFVpo6+xDNLkMLBvY2D1/5mssHX9RL22aG3rnd8\nhitTJaNLfOKN3NAldd/tMjluHLS0qOn4q+h6NEjJh3gscZ01dovk5QeXr197W+rG\nFwIDAQAB\n-----END PUBLIC KEY-----\n"

----------------------------------------------------------------------
    
Test Description: Successfully create a connection.

    Input:
    {"aesKey":"V3qLV+qBwPz+tbIll+6eYg==","apiKey":"m0ig54amrl87awtwlizcuji2bxacjm"}

    Expected Output:
    "Connection object containing AES key, connection ID, and timestamp"

    Actual Output:
    {"timestamp":"2024-01-04 01:41:53 UTC","connectionId":"f6e397c101667bb4b55587da53e9ae42","aesKey":"V3qLV+qBwPz+tbIll+6eYg=="}

----------------------------------------------------------------------
    
Test Description: Fail while creating a connection due to invalid API key.

    Input:
    {"aesKey":"HwqOqZ2xbOzyaXSjOhPlbQ==","apiKey":"thisisnotarealapikey12345"}

    Expected Output:
    "Connection failed!"

    Actual Output:
    "Connection failed!"

----------------------------------------------------------------------
    
Test Description: Successfully create a new job and return an order ID.

    Input:
    {"connection-id":"809e71b465e3128d72ea19297595d6a0"}

    Expected Output:
    "Order ID (string, length 20, alphanumeric)"

    Actual Output:
    "wg69BYhX7zv6BkN32Aw7"

----------------------------------------------------------------------
    
Test Description: Fail while creating a new job due to invalid connection ID.

    Input:
    {"connection-id":"thisisnotarealconnectionid12345"}

    Expected Output:
    "Job creation failed!"

    Actual Output:
    "Job creation failed!"

----------------------------------------------------------------------
    
Test Description: Successfully upload a file via File object.

    Input:
    "object"

    Expected Output:
    201

    Actual Output:
    201

----------------------------------------------------------------------
    
Test Description: Successfully upload a file via byte array (Uint8Array).

    Input:
    "object"

    Expected Output:
    201

    Actual Output:
    201

----------------------------------------------------------------------
    
Test Description: Successfully upload a dataset via array of File objects.

    Input:
    "object"

    Expected Output:
    201

    Actual Output:
    201

----------------------------------------------------------------------
    
Test Description: Successfully upload a dataset via Unit8Array.

    Input:
    "object"

    Expected Output:
    201

    Actual Output:
    201

----------------------------------------------------------------------
    
Test Description: Successfully run a job and return a status 202.

    Input:
    {"orderID":"AYdkHDeYxLeQqwRn1anh","productID":"PD/MSA/PSP-v1.0"}

    Expected Output:
    202

    Actual Output:
    202

----------------------------------------------------------------------
    
Test Description: Fail running a job due to invalid product ID.

    Input:
    {"connection-id":"e0811ad08b3fe70686c0988569628ad6","orderID":"i4KNIWk6Lfir5d8vIc8g","productID":"notARealProduct"}

    Expected Output:
    "Job run failed."

    Actual Output:
    "Job run failed."

----------------------------------------------------------------------
    
Test Description: Fail running a job due to invalid order ID.

    Input:
    {"connection-id":"8217d135cdbb16bdd1cdca8c10f62c14","orderID":"notARealOrderID","productID":"PD/MSA/PSP-v1.0"}

    Expected Output:
    "Job run failed."

    Actual Output:
    "Job run failed."

----------------------------------------------------------------------
    
Test Description: Fail running a job due to invalid connection ID.

    Input:
    {"connection-id":"notARealConnectionID","orderID":"oHjgcHQAM37TDCrTpJr6","productID":"PD/MSA/PSP-v1.0"}

    Expected Output:
    "Job run failed."

    Actual Output:
    "Job run failed."

----------------------------------------------------------------------
    
Test Description: Successfully check status of job.

    Input:
    {"connection-id":"53821cbc092e010b7443f259824a3c5f","orderID":"TEST"}

    Expected Output:
    {"started":true,"finished":true,"failed":false,"progress":100,"info":"Finished"}

    Actual Output:
    {"started":true,"finished":true,"failed":false,"progress":100,"info":"Finished"}

----------------------------------------------------------------------
    
Test Description: Fail checking job status due to invalid order ID.

    Input:
    {"connection-id":"f492275facf04d763d08901c5cebd57c","orderID":"invalidOrderID"}

    Expected Output:
    "Status check failed."

    Actual Output:
    "Status check failed."

----------------------------------------------------------------------
    
Test Description: Fail checking job status due to invalid connection ID.

    Input:
    {"connection-id":"noARealConnectionID","orderID":"TEST"}

    Expected Output:
    "Status check failed."

    Actual Output:
    "Status check failed."

----------------------------------------------------------------------
    
Test Description: Successfully retrieve job results in TXT format.

    Input:
    {"connection-id":"5c92b70c9c81690a3b600c86e0788d42","orderID":"TEST","format":"TXT"}

    Expected Output:
    "OrderID:TESTDate:2024-01-04Product:TESTPDprobabilityvs.MSA/PSP:62.6%MSAprobabilityvs.PSP:85.6%Biomarkerlevels:pSN=0.26,Putamen=0.19,SCP=0.48,MCP=0.07"

    Actual Output:
    "OrderID:TESTDate:2024-01-04Product:TESTPDprobabilityvs.MSA/PSP:62.6%MSAprobabilityvs.PSP:85.6%Biomarkerlevels:pSN=0.26,Putamen=0.19,SCP=0.48,MCP=0.07"

----------------------------------------------------------------------
    
Test Description: Successfully retrieve job results in JSON format.

    Input:
    {"connection-id":"477734e5d30448c8b25af3bfbd7c37ce","orderID":"TEST","format":"JSON"}

    Expected Output:
    "{\"orderID\":\"TEST\",\"date\":\"2024-01-04\",\"product\":\"TEST\",\"result\":{\"PDprobability\":\"62.6\",\"MSAprobability\":\"85.6\",\"FWpSN\":\"0.26\",\"FWPutamen\":\"0.19\",\"FWSCP\":\"0.48\",\"FWMCP\":\"0.07\"}}"

    Actual Output:
    "{\"orderID\":\"TEST\",\"date\":\"2024-01-04\",\"product\":\"TEST\",\"result\":{\"PDprobability\":\"62.6\",\"MSAprobability\":\"85.6\",\"FWpSN\":\"0.26\",\"FWPutamen\":\"0.19\",\"FWSCP\":\"0.48\",\"FWMCP\":\"0.07\"}}"

----------------------------------------------------------------------
    
Test Description: Successfully retrieve job results in XML format.

    Input:
    {"connection-id":"e67ddd6f055d34901d4cbef294a1b09f","orderID":"TEST","format":"XML"}

    Expected Output:
    "<?xmlversion=\"1.0\"encoding=\"UTF-8\"standalone=\"yes\"?><neuropacsorderID=\"TEST\"date=\"2024-01-04\"product=\"TEST\"><resultname=\"PDprobability\"value=\"62.6\"/><resultname=\"MSAprobability\"value=\"85.6\"/><dataname=\"FWpSN\"value=\"0.26\"/><dataname=\"FWPutamen\"value=\"0.19\"/><dataname=\"FWSCP\"value=\"0.48\"/><dataname=\"FWMCP\"value=\"0.07\"/></neuropacs>"

    Actual Output:
    "<?xmlversion=\"1.0\"encoding=\"UTF-8\"standalone=\"yes\"?><neuropacsorderID=\"TEST\"date=\"2024-01-04\"product=\"TEST\"><resultname=\"PDprobability\"value=\"62.6\"/><resultname=\"MSAprobability\"value=\"85.6\"/><dataname=\"FWpSN\"value=\"0.26\"/><dataname=\"FWPutamen\"value=\"0.19\"/><dataname=\"FWSCP\"value=\"0.48\"/><dataname=\"FWMCP\"value=\"0.07\"/></neuropacs>"

----------------------------------------------------------------------
    
Test Description: Fail to check job status due to invalid result format.

    Input:
    {"connection-id":"a2377772fbbcb679212692dbd3662f97","orderID":"TEST","format":"noARealFormat"}

    Expected Output:
    "Result retrieval failed!"

    Actual Output:
    "Result retrieval failed!"

----------------------------------------------------------------------
    
Test Description: Fail to check job status due to invalid order ID.

    Input:
    {"orderID":"noARealOrderID","format":"TXT"}

    Expected Output:
    "Result retrieval failed!"

    Actual Output:
    "Result retrieval failed!"

----------------------------------------------------------------------
    
Test Description: Fail to check job status due to invalid connection ID.

    Input:
    {"connection-id":"notARealConnectionID","orderID":"TEST","format":"TXT"}

    Expected Output:
    "Result retrieval failed!"

    Actual Output:
    "Result retrieval failed!"

----------------------------------------------------------------------
 PASS  tests/neuropacs.test.js (13.649 s)
  NeuroPACS Class Tests
    ✓ should successfully retrieve a public key (141 ms)
    ✓ should successfully connect to server and return a connection object (262 ms)
    ✓ should fail when connecting to server due to invalid API key (258 ms)
    ✓ should successfully create a new job and return an order id (368 ms)
    ✓ should fail when create a new job due to invalid connection id (108 ms)
    ✓ should successfully upload a File object to the server (940 ms)
    ✓ should successfully upload a Uint8Array to the server (2022 ms)
    ✓ should successfully upload a File object dataset to the server (1463 ms)
    ✓ should successfully upload a Uint8Array dataset to the server (1274 ms)
    ✓ should successfully upload a Uint8Array to the server (513 ms)
    ✓ should fail due to invalid product ID (532 ms)
    ✓ should fail due to invalid order ID (414 ms)
    ✓ should fail due to invalid connection ID (542 ms)
    ✓ should successfully upload a Uint8Array to the server (1384 ms)
    ✓ should fail due to invalid order id (365 ms)
    ✓ should fail due to invalid order id (393 ms)
    ✓ should successfully retrieve results in TXT format (370 ms)
    ✓ should successfully retrieve results in JSON format (377 ms)
    ✓ should successfully retrieve results in XML format (376 ms)
    ✓ should fail due to invalid result format (252 ms)
    ✓ should fail due to invalid order id (396 ms)
    ✓ should fail due to invalid order id (373 ms)

Test Suites: 1 passed, 1 total
Tests:       22 passed, 22 total
Snapshots:   0 total
Time:        13.911 s, estimated 14 s
Ran all test suites.